<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/rooctblog/blog/rss.xml" title="Develop Site Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/rooctblog/blog/atom.xml" title="Develop Site Blog Atom Feed"><title data-react-helmet="true">DOR DNP DNPD | Develop Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://rooct.github.io/rooctblog/docs/dapps/Example/DORToken"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="DOR DNP DNPD | Develop Site"><meta data-react-helmet="true" name="description" content="合约地址 0xbCC0b9Ce95d8934E7Eaf56A7D890fb4eDB20DA37"><meta data-react-helmet="true" property="og:description" content="合约地址 0xbCC0b9Ce95d8934E7Eaf56A7D890fb4eDB20DA37"><link data-react-helmet="true" rel="shortcut icon" href="/rooctblog/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://rooct.github.io/rooctblog/docs/dapps/Example/DORToken"><link data-react-helmet="true" rel="alternate" href="https://rooct.github.io/rooctblog/docs/dapps/Example/DORToken" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://rooct.github.io/rooctblog/docs/dapps/Example/DORToken" hreflang="x-default"><link rel="stylesheet" href="/rooctblog/assets/css/styles.63c342b0.css">
<link rel="preload" href="/rooctblog/assets/js/runtime~main.94a52f42.js" as="script">
<link rel="preload" href="/rooctblog/assets/js/main.a3c9c5c8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rooctblog/"><img src="/rooctblog/img/logo.svg" alt="Dev Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/rooctblog/img/logo.svg" alt="Dev Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Dev Site</b></a><a class="navbar__item navbar__link" href="/rooctblog/docs/intro">Solidity</a><a class="navbar__item navbar__link" href="/rooctblog/docs/evm">EVM</a><a class="navbar__item navbar__link navbar__link--active" href="/rooctblog/docs/dapp">Dapps</a><a class="navbar__item navbar__link" href="/rooctblog/docs/devtool">DevTools</a><a class="navbar__item navbar__link" href="/rooctblog/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist" href="#">Dapps</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rooctblog/docs/dapp">smartcontract</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DEX</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Event</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Example</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rooctblog/docs/dapps/Example/DORToken">DOR DNP DNPD</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rooctblog/docs/dapps/Example/Multicall">Multicall</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rooctblog/docs/dapps/Example/代理投票">代理投票</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rooctblog/docs/dapps/Example/以太虾农庄">以太虾农庄</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rooctblog/docs/dapps/Example/供应链">供应链</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rooctblog/docs/dapps/Example/公开拍卖">公开拍卖</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rooctblog/docs/dapps/Example/密封拍卖">密封拍卖</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rooctblog/docs/dapps/Example/物品买卖">物品买卖</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">GunPool</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Loan</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">NFT</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Robot</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Solidity</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">StableCoin</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>DOR DNP DNPD</h1></header><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="合约地址-0xbcc0b9ce95d8934e7eaf56a7d890fb4edb20da37"></a>合约地址 0xbCC0b9Ce95d8934E7Eaf56A7D890fb4eDB20DA37<a class="hash-link" href="#合约地址-0xbcc0b9ce95d8934e7eaf56a7d890fb4edb20da37" title="Direct link to heading">#</a></h3><p><img src="https://bscscan.com/address/0xbcc0b9ce95d8934e7eaf56a7d890fb4edb20da37#code" alt="合约链接"></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: MIT</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity 0.7.6;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@openzeppelin/contracts/math/SafeMath.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@openzeppelin/contracts/math/Math.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@openzeppelin/contracts/utils/Context.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@openzeppelin/contracts/math/SafeMath.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;../interfaces/IDayOfRightsClub.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;../interfaces/IReferral.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;../interfaces/IFactory.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;../interfaces/IRouter.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;hardhat/console.sol&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @dev Implementation of the {IERC20} interface.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * This implementation is agnostic to the way tokens are created. This means</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * that a supply mechanism has to be added in a derived contract using {_mint}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * For a generic mechanism see {ERC20PresetMinterPauser}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * TIP: For a detailed writeup see our guide</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * https://forum.zeppelin.solutions/t/how-to-implement-erc20-supply-mechanisms/226[How</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * to implement supply mechanisms].</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * We have followed general OpenZeppelin guidelines: functions revert instead</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * of returning `false` on failure. This behavior is nonetheless conventional</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * and does not conflict with the expectations of ERC20 applications.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Additionally, an {Approval} event is emitted on calls to {transferFrom}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * This allows applications to reconstruct the allowance for all accounts just</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * by listening to said events. Other implementations of the EIP may not emit</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * these events, as it isn&#x27;t required by the specification.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Finally, the non-standard {decreaseAllowance} and {increaseAllowance}</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * functions have been added to mitigate the well-known issues around setting</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * allowances. See {IERC20-approve}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">contract ERC20 is Context, IERC20 {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    using SafeMath for uint256;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) internal _balances;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; mapping(address =&gt; uint256)) private _allowances;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 internal _totalSupply;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    string private _name;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    string private _symbol;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint8 private _decimals;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Sets the values for {name} and {symbol}, initializes {decimals} with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * a default value of 18.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * To select a different value for {decimals}, use {_setupDecimals}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * All three of these values are immutable: they can only be set once during</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * construction.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(string memory name_, string memory symbol_) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _name = name_;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _symbol = symbol_;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _decimals = 18;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Returns the name of the token.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function name() public view virtual returns (string memory) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _name;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Returns the symbol of the token, usually a shorter version of the</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * name.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function symbol() public view virtual returns (string memory) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _symbol;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Returns the number of decimals used to get its user representation.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * For example, if `decimals` equals `2`, a balance of `505` tokens should</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * be displayed to a user as `5,05` (`505 / 10 ** 2`).</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Tokens usually opt for a value of 18, imitating the relationship between</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Ether and Wei. This is the value {ERC20} uses, unless {_setupDecimals} is</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * called.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * NOTE: This information is only used for _display_ purposes: it in</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * no way affects any of the arithmetic of the contract, including</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * {IERC20-balanceOf} and {IERC20-transfer}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function decimals() public view virtual returns (uint8) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _decimals;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev See {IERC20-totalSupply}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function totalSupply() public view virtual override returns (uint256) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _totalSupply;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev See {IERC20-balanceOf}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function balanceOf(address account)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        public</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        view</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        virtual</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        returns (uint256)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _balances[account];</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev See {IERC20-transfer}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Requirements:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `recipient` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - the caller must have a balance of at least `amount`.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function transfer(address recipient, uint256 amount)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        public</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        virtual</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        returns (bool)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _transfer(_msgSender(), recipient, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev See {IERC20-allowance}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function allowance(address owner, address spender)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        public</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        view</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        virtual</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        returns (uint256)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _allowances[owner][spender];</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev See {IERC20-approve}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Requirements:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `spender` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function approve(address spender, uint256 amount)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        public</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        virtual</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        returns (bool)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _approve(_msgSender(), spender, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev See {IERC20-transferFrom}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Emits an {Approval} event indicating the updated allowance. This is not</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * required by the EIP. See the note at the beginning of {ERC20}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Requirements:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `sender` and `recipient` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `sender` must have a balance of at least `amount`.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - the caller must have allowance for ``sender``&#x27;s tokens of at least</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * `amount`.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function transferFrom(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address sender,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address recipient,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 amount</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) public virtual override returns (bool) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _transfer(sender, recipient, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _approve(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            sender,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            _msgSender(),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            _allowances[sender][_msgSender()].sub(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                amount,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;ERC20: transfer amount exceeds allowance&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Atomically increases the allowance granted to `spender` by the caller.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * This is an alternative to {approve} that can be used as a mitigation for</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * problems described in {IERC20-approve}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Emits an {Approval} event indicating the updated allowance.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Requirements:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `spender` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function increaseAllowance(address spender, uint256 addedValue)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        public</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        virtual</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        returns (bool)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _approve(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            _msgSender(),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            spender,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            _allowances[_msgSender()][spender].add(addedValue)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Atomically decreases the allowance granted to `spender` by the caller.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * This is an alternative to {approve} that can be used as a mitigation for</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * problems described in {IERC20-approve}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Emits an {Approval} event indicating the updated allowance.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Requirements:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `spender` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `spender` must have allowance for the caller of at least</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * `subtractedValue`.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function decreaseAllowance(address spender, uint256 subtractedValue)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        public</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        virtual</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        returns (bool)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _approve(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            _msgSender(),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            spender,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            _allowances[_msgSender()][spender].sub(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                subtractedValue,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;ERC20: decreased allowance below zero&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Moves tokens `amount` from `sender` to `recipient`.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * This is internal function is equivalent to {transfer}, and can be used to</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * e.g. implement automatic token fees, slashing mechanisms, etc.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Emits a {Transfer} event.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Requirements:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `sender` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `recipient` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `sender` must have a balance of at least `amount`.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _transfer(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address sender,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address recipient,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 amount</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) internal virtual {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(sender != address(0), &quot;ERC20: transfer from the zero address&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(recipient != address(0), &quot;ERC20: transfer to the zero address&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _beforeTokenTransfer(sender, recipient, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _balances[sender] = _balances[sender].sub(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            amount,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ERC20: transfer amount exceeds balance&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _balances[recipient] = _balances[recipient].add(amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit Transfer(sender, recipient, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** @dev Creates `amount` tokens and assigns them to `account`, increasing</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * the total supply.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Emits a {Transfer} event with `from` set to the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Requirements:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `to` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _mint(address account, uint256 amount) internal virtual {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(account != address(0), &quot;ERC20: mint to the zero address&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _beforeTokenTransfer(address(0), account, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _totalSupply = _totalSupply.add(amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _balances[account] = _balances[account].add(amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit Transfer(address(0), account, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Destroys `amount` tokens from `account`, reducing the</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * total supply.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Emits a {Transfer} event with `to` set to the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Requirements:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `account` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `account` must have at least `amount` tokens.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _burn(address account, uint256 amount) internal virtual {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(account != address(0), &quot;ERC20: burn from the zero address&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _beforeTokenTransfer(account, address(0), amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _balances[account] = _balances[account].sub(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            amount,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ERC20: burn amount exceeds balance&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _totalSupply = _totalSupply.sub(amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit Transfer(account, address(0), amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Sets `amount` as the allowance of `spender` over the `owner` s tokens.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * This internal function is equivalent to `approve`, and can be used to</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * e.g. set automatic allowances for certain subsystems, etc.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Emits an {Approval} event.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Requirements:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `owner` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `spender` cannot be the zero address.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _approve(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address owner,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address spender,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 amount</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) internal virtual {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(owner != address(0), &quot;ERC20: approve from the zero address&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(spender != address(0), &quot;ERC20: approve to the zero address&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _allowances[owner][spender] = amount;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit Approval(owner, spender, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Sets {decimals} to a value other than the default one of 18.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * WARNING: This function should only be called from the constructor. Most</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * applications that interact with token contracts will not expect</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * {decimals} to ever change, and may work incorrectly if it does.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _setupDecimals(uint8 decimals_) internal virtual {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _decimals = decimals_;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @dev Hook that is called before any transfer of tokens. This includes</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * minting and burning.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Calling conditions:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - when `from` and `to` are both non-zero, `amount` of ``from``&#x27;s tokens</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * will be to transferred to `to`.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - when `from` is zero, `amount` tokens will be minted for `to`.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - when `to` is zero, `amount` of ``from``&#x27;s tokens will be burned.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * - `from` and `to` are never both zero.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _beforeTokenTransfer(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address from,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address to,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 amount</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) internal virtual {}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">contract SmartVault {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    IERC20 public usdtToken;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    IERC20 public dorToken;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function initialize(IERC20 _usdtToken, IERC20 _dorToken) external {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(address(usdtToken) == address(0), &quot;has been initialized&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        usdtToken = _usdtToken;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        dorToken = _dorToken;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        usdtToken.approve(address(dorToken), uint256(-1));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function approve() external {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        usdtToken.approve(address(dorToken), uint256(-1));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">contract DORToken is ERC20, Ownable {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    using SafeMath for uint256;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    using Address for address;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public constant BASE_RATIO = 10**18;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public constant MAX_FEE = (20 * BASE_RATIO) / 100;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public constant SPY = (208 * BASE_RATIO) / 10000 / 1 days;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public immutable rewardEndTime;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; bool) private minner;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; bool) public whitelist;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) public lastUpdateTime;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; bool) public rewardBlacklist;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public fundFeePercent = (4 * BASE_RATIO) / 100;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public liquidityFeePercent = (2 * BASE_RATIO) / 100;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public nftPoolFeePercent = (2 * BASE_RATIO) / 100;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public currentAllFee =</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        fundFeePercent + liquidityFeePercent + nftPoolFeePercent;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    bool private inSwapAndLiquify;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public minSwapAndLiquifyLimit = 100 * 10**18;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public minSwapLimit = 100 * 10**18;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    IReferral public referralHandle;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    IERC20 public usdtToken;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    address public liquidity;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    address public fund;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    address public lpReceiver;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    address public nftPool;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    address private smartVault;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    IRouter public router;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 public extraSupply;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    bool public canTransfer;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    event SwapAndLiquify(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 tokensSwapped,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 ethReceived,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 tokensIntoLiqudity</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    event AddWhitelist(address account);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    event DelWhitelist(address account);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory _name,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory _symbol,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint8 _decimals,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address _fund,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address _lpReceiver,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address _usdtToken,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        IFactory _factory,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        IRouter _router</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) ERC20(_name, _symbol) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _setupDecimals(_decimals);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        fund = _fund;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        lpReceiver = _lpReceiver;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        usdtToken = IERC20(_usdtToken);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        liquidity = _factory.createPair(_usdtToken, address(this));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        router = _router;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        rewardEndTime = block.timestamp.add(730 days);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        setRewardBlacklist(liquidity, true);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        setRewardBlacklist(address(this), true);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes memory bytecode = type(SmartVault).creationCode;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 salt = keccak256(abi.encodePacked(address(this)));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address _smartVault;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        assembly {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            _smartVault := create2(0, add(bytecode, 32), mload(bytecode), salt)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        SmartVault(_smartVault).initialize(usdtToken, this);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        smartVault = _smartVault;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setMinSwapAndLiquifyLimit(uint256 min) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        minSwapAndLiquifyLimit = min;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setMinSwapLimit(uint256 min) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        minSwapLimit = min;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setCanTransfer(bool enable) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        canTransfer = enable;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setFundFeePercent(uint256 percent)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        external</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        onlyOwner</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        checkMaxFeeLimit(fundFeePercent, percent)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        fundFeePercent = percent;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setLiquidityFeePercent(uint256 percent)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        external</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        onlyOwner</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        checkMaxFeeLimit(liquidityFeePercent, percent)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        liquidityFeePercent = percent;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setNFTPoolFeePercent(uint256 percent)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        external</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        onlyOwner</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        checkMaxFeeLimit(nftPoolFeePercent, percent)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        nftPoolFeePercent = percent;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier checkMaxFeeLimit(uint256 oldFee, uint256 newFee) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        currentAllFee = currentAllFee.sub(oldFee).add(newFee);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(currentAllFee &gt; MAX_FEE, &quot;trade fee exceeded maximum limit&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setReferralHandle(address _referralContract) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        referralHandle = IReferral(_referralContract);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setMinner(address _minner, bool enable) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        minner[_minner] = enable;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function isMinner(address account) public view returns (bool) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return minner[account];</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier onlyMinner() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(isMinner(msg.sender), &quot;caller is not minter&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setRouter(IRouter _router) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        router = _router;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setNFTPool(address _nftPool) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        nftPool = _nftPool;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setFund(address _fund) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        fund = _fund;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setLpReceiver(address _lpReceiver) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        lpReceiver = _lpReceiver;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function addWhitelist(address _addr) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        whitelist[_addr] = true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit AddWhitelist(_addr);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function delWhitelist(address _addr) external onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        delete whitelist[_addr];</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit DelWhitelist(_addr);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function mint(address to, uint256 value) external onlyMinner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _mint(to, value);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _transfer(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address from,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address to,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 amount</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) internal virtual override {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!whitelist[from] &amp;&amp; !whitelist[to]) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            amount = calculateFee(from, to, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        super._transfer(from, to, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function transferFrom(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address sender,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address recipient,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 amount</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) public virtual override returns (bool) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            canTransfer || whitelist[sender] || whitelist[recipient],</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;can not transfer&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return super.transferFrom(sender, recipient, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function transfer(address recipient, uint256 amount)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        public</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        virtual</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        returns (bool)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            canTransfer || whitelist[recipient] || whitelist[_msgSender()],</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;can not transfer&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return super.transfer(recipient, amount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function calculateFee(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address from,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address to,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 amount</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) internal returns (uint256) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 realAmount = amount;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address account = from;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 nftFee = amount.mul(nftPoolFeePercent).div(BASE_RATIO);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (nftPool != address(0) &amp;&amp; nftFee &gt; 0) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            realAmount = realAmount.sub(nftFee);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            super._transfer(account, nftPool, nftFee);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 fundFee = amount.mul(fundFeePercent).div(BASE_RATIO);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (fund != address(0) &amp;&amp; fundFee &gt; 0) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            realAmount = realAmount.sub(fundFee);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            super._transfer(account, smartVault, fundFee);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 liquidityFee = amount.mul(liquidityFeePercent).div(BASE_RATIO);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (liquidityFee &gt; 0) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            realAmount = realAmount.sub(liquidityFee);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            super._transfer(account, address(this), liquidityFee);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            from != liquidity &amp;&amp;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            to != liquidity &amp;&amp;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            balanceOf(address(this)) &gt; minSwapAndLiquifyLimit &amp;&amp;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            !inSwapAndLiquify</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        ) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            swapAndLiquify();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 smartVaultBalance = balanceOf(address(smartVault));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            from != liquidity &amp;&amp;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            to != liquidity &amp;&amp;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            fund != address(0) &amp;&amp;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            smartVaultBalance &gt; minSwapLimit &amp;&amp;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            !inSwapAndLiquify</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        ) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            inSwapAndLiquify = true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            super._transfer(smartVault, address(this), smartVaultBalance);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            swapTokensForToken(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                smartVaultBalance,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                address(this),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                address(usdtToken),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                fund</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            inSwapAndLiquify = false;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return realAmount;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function swapAndLiquify() private lockTheSwap {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 contractTokenBalance = balanceOf(address(this));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 half = contractTokenBalance.div(2);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 otherHalf = contractTokenBalance.sub(half);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 initialBalance = usdtToken.balanceOf(smartVault);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        swapTokensForToken(half, address(this), address(usdtToken), smartVault);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 newBalance = usdtToken.balanceOf(smartVault).sub(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            initialBalance</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        addLiquidity(newBalance, otherHalf);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit SwapAndLiquify(half, newBalance, otherHalf);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function swapTokensForToken(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 tokenAmount,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address path0,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address path1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address to</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) private {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address[] memory path = new address[](2);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        path[0] = path0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        path[1] = path1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        IERC20(path[0]).approve(address(router), tokenAmount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        router.swapExactTokensForTokensSupportingFeeOnTransferTokens(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            tokenAmount,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            0,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            path,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            to,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            block.timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function addLiquidity(uint256 usdtAmount, uint256 tokenAmount) private {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // approve token transfer to cover all possible scenarios</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _approve(address(this), address(router), tokenAmount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        usdtToken.transferFrom(smartVault, address(this), usdtAmount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        usdtToken.approve(address(router), usdtAmount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // add the liquidity</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        router.addLiquidity(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            address(usdtToken),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            address(this),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            usdtAmount,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            tokenAmount,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            0, // slippage is unavoidable</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            0, // slippage is unavoidable</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            lpReceiver,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            block.timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier lockTheSwap() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        inSwapAndLiquify = true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        inSwapAndLiquify = false;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function balanceOf(address account)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        public</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        view</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        virtual</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        returns (uint256)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _balances[account].add(getReward(account));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function totalSupply() public view virtual override returns (uint256) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _totalSupply.add(extraSupply);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function setRewardBlacklist(address account, bool enable) public onlyOwner {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        rewardBlacklist[account] = enable;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getReward(address account) public view returns (uint256) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (lastUpdateTime[account] == 0 || rewardBlacklist[account]) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            return 0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            _balances[account].mul(SPY).div(BASE_RATIO).mul(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                lastTime().sub(lastUpdateTime[account])</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function lastTime() public view returns (uint256) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Math.min(block.timestamp, rewardEndTime);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier calculateReward(address account) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (account != address(0)) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            uint256 reward = getReward(account);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (reward &gt; 0) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                _balances[account] = _balances[account].add(reward);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                extraSupply = extraSupply.add(reward);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            lastUpdateTime[account] = lastTime();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _beforeTokenTransfer(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address from,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        address to,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 amount</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) internal virtual override calculateReward(from) calculateReward(to) {}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/rooctblog/docs/dapps/Event/X2Y2_DecentralizedOrderReward"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« X2Y2: 必须修改的中心化NFT挂单奖励机制</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/rooctblog/docs/dapps/Example/Multicall"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Multicall »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#合约地址-0xbcc0b9ce95d8934e7eaf56a7d890fb4edb20da37" class="table-of-contents__link">合约地址 0xbCC0b9Ce95d8934E7Eaf56A7D890fb4eDB20DA37</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Solidity</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/rooctblog/docs/solidity/example/Helloworld">HelloWorld</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/rooctblog/">Stack Overflow</a></li></ul></div><div class="col footer__col"><div class="footer__title">Feature</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/rooctblog/">Feature</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/rooctblog/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/rooctblog/">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 dev site, Inc. Built with dev.</div></div></div></footer></div>
<script src="/rooctblog/assets/js/runtime~main.94a52f42.js"></script>
<script src="/rooctblog/assets/js/main.a3c9c5c8.js"></script>
</body>
</html>